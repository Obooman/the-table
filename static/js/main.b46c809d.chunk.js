(this["webpackJsonpthe-table"]=this["webpackJsonpthe-table"]||[]).push([[0],{16:function(e,t,n){e.exports={rowHeaderItem:"main_rowHeaderItem__3Llca"}},17:function(e,t,n){e.exports={columnTitle:"main_columnTitle__1FTAc"}},19:function(e,t,n){e.exports={cell:"main_cell__1Fu2A"}},21:function(e,t,n){e.exports=n(32)},32:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(8),c=n.n(o),l=n(3),i=n(4),s=n(14),u=n.n(s),f=n(7),p=n.n(f);function d(e){var t,n=e.size,o=e.cellSize,c=e.getData,s=e.onClick,f=e.theme,d=void 0===f?{}:f,m=e.scrollLeft,v=void 0===m?0:m,b=e.scrollTop,h=void 0===b?0:b,w=e.onScroll,E=e.children,_=Object(r.useRef)(),O=Object(r.useState)([0,0]),g=Object(i.a)(O,2),j=g[0],y=g[1],C=Object(r.useState)([0,0]),x=Object(i.a)(C,2),k=x[0],T=x[1],N=Object(r.useState)([0,0]),S=Object(i.a)(N,2),B=S[0],I=S[1],M=Object(r.useState)([0,0]),L=Object(i.a)(M,2),z=L[0],A=L[1];Object(r.useEffect)((function(){var e=_.current.offsetWidth,t=_.current.offsetHeight,r=Math.ceil(e/o[0]),a=Math.ceil(t/o[1]),c=n[0]%r,l=n[1]%a,i=(2*r>n[0]?n[0]:2*r)+c,s=(2*a>n[1]?n[1]:2*a)+l,u=parseInt(n[0]/r)-1,f=parseInt(n[1]/a)-1;u>2&&(u-=1),f>2&&(f-=1),I([r,a]),T([i,s]),A([u,f])}),[n,o]),Object(r.useEffect)((function(){var e=_.current,t=function(){var t=e.scrollTop,n=e.scrollLeft,r=!1,a=Object(i.a)(j,2),c=a[0],l=a[1],s=parseInt(n/(B[0]*o[0])),u=parseInt(t/(B[1]*o[1]));(s=s>z[0]?z[0]:s)!==c&&(r=!0),(u=u>z[1]?z[1]:u)!==l&&(r=!0),r&&y([s,u]),w&&w({scrollLeft:n,scrollTop:t})};return e.addEventListener("scroll",t,!1),function(){return e.removeEventListener("scroll",t,!1)}}),[k,j,o,w,B,z]);var V=u()((t={},Object(l.a)(t,p.a.grey,d.isGrey),Object(l.a)(t,p.a.tableContainer,!0),Object(l.a)(t,p.a.barless,d.barless),t));return Object(r.useEffect)((function(){_.current.scrollLeft=v,_.current.scrollTop=h}),[v,h]),a.a.createElement("div",{ref:_,className:V},a.a.createElement("div",{style:{width:n[0]*o[0],height:n[1]*o[1],overflow:"hidden"},onClick:s},a.a.createElement("div",{className:p.a.tableContent,style:{width:k[0]*o[0],height:k[1]*o[1],left:j[0]*B[0]*o[0],top:j[1]*B[1]*o[1]}},Array.from({length:k[0]}).map((function(e,t){return Array.from({length:k[1]}).map((function(e,n){return c({relative:{row:n,column:t},absolute:{row:j[1]*B[1]+n,column:j[0]*B[0]+t}})}))}))),E))}var m=n(2),v=n(16),b=n.n(v),h=Object(m.b)((function(e){return{scrollTop:e.editor.scrollPosition.scrollTop}}))((function(e){var t=e.scrollTop;return a.a.createElement(d,{size:[1,1e3],cellSize:[60,20],getData:function(e){var t=e.relative,n=t.row,r=t.column,o=e.absolute.row;return a.a.createElement("span",{className:b.a.rowHeaderItem,key:"".concat(n,"-").concat(r),style:{left:60*r,top:20*n}},o+1)},theme:{barless:!0,isGrey:!0},scrollTop:t})})),w="a".charCodeAt(0),E="z".charCodeAt(0)-w+1;var _=n(17),O=n.n(_),g=Object(m.b)((function(e){return{scrollLeft:e.editor.scrollPosition.scrollLeft}}))((function(e){var t=e.scrollLeft;return a.a.createElement(d,{size:[1e3,1],cellSize:[60,20],getData:function(e){var t=e.relative,n=t.row,r=t.column,o=e.absolute.column;return a.a.createElement("span",{key:"".concat(n,"-").concat(r),className:O.a.columnTitle,style:{left:60*r,top:20*n}},function(e){for(var t="";e>=0;)t=String.fromCharCode(e%E+w)+t,e=Math.floor(e/E)-1;return t}(o).toUpperCase())},theme:{isGrey:!0,barless:!0},scrollLeft:t})})),j=n(18),y=function(e){var t=e.toString();return/\./.test(t)?t.length-t.indexOf(".")-1:0},C={ExpressionStatement:!0,BinaryExpression:!0,UnaryExpression:!0,CallExpression:!0,Literal:!0,Identifier:!0},x="addition",k="subtraction",T="multiplication",N=function(e,t,n){var r=Math.pow(10,Math.max(y(e),y(t)));switch(n){case x:return(e*r+t*r)/r;case k:return(e*r-t*r)/r;case T:return e*r*t*r/r/r;default:throw new Error("Invalid arithmetic operator")}};var S=function(e){return/^[a-z]{1,3}\d{1,8}$$/gim.test(e)},B=function(e){return 1};function I(){for(var e=0,t=0,n=0,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];for(;e<a.length;){var c=a[e];"string"===typeof c&&(c=Number(c)),"number"!==typeof c&&(c=0);var l=y(c);l>n?(t*=Math.pow(10,l-n),c*=Math.pow(10,l),n=l):l<=n&&(c*=Math.pow(10,n)),t+=c,e++}return t/Math.pow(10,n)}var M={SUM:I,AVG:function(){return 0===arguments.length?0:I.apply(void 0,arguments)/arguments.length},PI:function(){return Math.PI}},L=function(e){return e.toUpperCase()in M},z=function(e){return L(e)&&M[e.toUpperCase()]},A=document.createElement("canvas").getContext("2d");function V(e){return void 0===e?0:(A.font="16px sans-serif",A.measureText(e).width)}var P=n(5),U=n.n(P),F=Object(m.b)((function(e){return{sheets:e.sheets}}))((function(e){var t=e.dispatch,n=e.onBlur,o=e.sheets,c=e.row,l=e.col,s=(o.rows[c]||{})[l]||{expression:"",value:""},u=Object(r.useState)(parseInt(V(s.expression)/59)+1),f=Object(i.a)(u,2),p=f[0],d=f[1];Object(r.useEffect)((function(){d(parseInt(V(s.expression)/59)+1)}),[s.expression]);var m=function(e){var r,a,o=e.target.value,s=/^=/.test(o);if(s){var u=function(e,t,n){var r=t.isVariable,a=t.getVariableValue,o=n.isFunction,c=n.getFunction;try{return[!1,function e(t){if(!C[t.type])throw new Error("Unsupported syntax block"+t.type);if("Literal"===t.type){if(!/\d+/.test(t.value))throw new Error("invalid literal value");return t.value}if("UnaryExpression"===t.type){if(!/\+|-/.test(t.operator))throw new Error("Invalid Unary Expression");return"+"===t.operator?e(t.argument):-e(t.argument)}if("BinaryExpression"===t.type){var n=e(t.right);switch(t.operator){case"+":return N(e(t.left),e(t.right),x);case"-":return N(e(t.left),e(t.right),k);case"*":return N(e(t.left),e(t.right),T);case"/":if(0===n)throw new Error("Got 0 as division");return e(t.left)/n;case"%":if(0===n)throw new Error("Got 0 as division");return e(t.left)%n;default:throw new Error("Unknown operator detected")}}if("CallExpression"===t.type){var l=t.callee.name;if(o(l))return c(l).apply(this,t.arguments.map((function(t){return e(t)})));throw new Error("calling unknown inset function")}if("Identifier"===t.type){if(r(t.name))return a(t.name);throw new Error("using undefined variable")}}(j.a(e,{ecmaVersion:2020}).body[0].expression)]}catch(l){return[l,0]}}(a=o.slice(1),{isVariable:S,getVariableValue:B},{isFunction:L,getFunction:z}),f=Object(i.a)(u,2),p=f[0],d=f[1];r=p?"#ERROR":d}else r=o;t.sheets.updateValue({row:c,column:l,isExpression:s,value:r,expression:a}),n&&n(e)};return a.a.createElement("div",null,a.a.createElement("div",{className:U.a.focusBlock,style:{width:59*p},onChange:function(e){V(e.target.value)>59*p&&d(p+1)},onClick:function(e){e.stopPropagation()}},a.a.createElement("input",{defaultValue:s.isExpression?"=".concat(s.expression):s.value,autoFocus:!0,type:"text",className:U.a.editingBorderTextContent,onBlur:function(e){m(e),n&&n(e)},onKeyDown:function(e){"Enter"===e.key&&m(e)}})))})),H=Object(m.b)((function(e){return{sheets:e.sheets}}))((function(e){var t=e.sheets,n=e.row,r=e.col,o=(t.rows[n]||{})[r]||{},c="value"in o?o.value:"";return a.a.createElement("div",{className:U.a.focusBlock},c)})),G=n(1),W="focused",D="editing",R={state:{mode:"normal",cell:{width:60,height:20},scrollPosition:{scrollLeft:0,scrollTop:0},focusCell:{row:0,col:0}},reducers:{updateScrollPosition:function(e,t){return Object(G.a)(Object(G.a)({},e),{},{scrollPosition:t})},updateMode:function(e,t){return Object(G.a)(Object(G.a)({},e),{},{mode:t})},updateFocusCell:function(e,t){return Object(G.a)(Object(G.a)({},e),{},{focusCell:t})}},effects:function(e){return{}}},J=Object(m.b)((function(e){return{sheets:e.sheets,mode:e.editor.mode,focusCell:e.editor.focusCell}}))((function(e){var t=e.dispatch,n=e.focusCell,r=n.row,o=n.col,c=e.mode,l={left:60*o,top:20*r};return c===W?a.a.createElement("div",{onDoubleClick:function(e){t.editor.updateMode(D)},onClick:function(e){e.stopPropagation()},className:U.a.activeCellWrapper,style:l},a.a.createElement(H,{row:r,col:o})):c===D?a.a.createElement("div",{className:U.a.activeCellWrapper,style:l},a.a.createElement(F,{row:r,col:o,onBlur:function(){t.editor.updateMode(W)}})):null})),Q=n(19),Z=n.n(Q);var $=Object(m.b)((function(e){return{sheets:e.sheets}}))((function(e){var t=e.relative,n=t.row,r=t.column,o=e.absolute,c=o.row,l=o.column,i=(e.sheets.rows[c]||{})[l]||{},s="value"in i?i.value:"";return a.a.createElement("div",{className:Z.a.cell,key:"".concat(n,"-").concat(r),style:{left:60*r,top:20*n}},s)})),q=Object(m.b)((function(e){return{sheets:e.sheets}}))((function(e){var t=e.dispatch,n=e.sheets;return a.a.createElement(d,{size:[1e3,1e3],cellSize:[60,20],getData:function(e){var t,r,o=e.relative,c=o.row,l=o.column,i=e.absolute,s=i.row,u=i.column;return(null===(t=n.rows)||void 0===t||null===(r=t[s])||void 0===r?void 0:r[u])?a.a.createElement($,Object.assign({key:"".concat(c,"-").concat(l)},e)):null},onClick:function(e){t.editor.updateFocusCell({row:parseInt(e.nativeEvent.offsetY/20),col:parseInt(e.nativeEvent.offsetX/60)}),t.editor.updateMode(W)},theme:{isGrey:!1},onScroll:function(e){t.editor.updateScrollPosition(e)}},a.a.createElement(J,null))})),K=n(6),X=n.n(K);var Y=function(){return a.a.createElement("div",{className:X.a.app},a.a.createElement("div",{className:X.a.tableApplication},a.a.createElement("div",{className:X.a.rowsTitle},a.a.createElement("div",{className:X.a.cornerBlock}),a.a.createElement(h,null)),a.a.createElement("div",{className:X.a.dataContent},a.a.createElement("div",{className:X.a.columnHeader},a.a.createElement(g,null)),a.a.createElement("div",{className:X.a.contentTable},a.a.createElement(q,null)))))},ee=n(20),te={state:{rows:{},columns:{}},reducers:{updateValue:function(e,t){return Object(G.a)(Object(G.a)({},e),{},{rows:Object(G.a)(Object(G.a)({},e.rows),{},Object(l.a)({},t.row,Object(G.a)(Object(G.a)({},e.rows[t.row]),{},Object(l.a)({},t.column,t))))})},changeRow:function(e,t){var n=e.rows[11];return delete e.rows[11],Object(G.a)(Object(G.a)({},e),{},{rows:Object(G.a)(Object(G.a)({},e.rows),{},{13:n})})}},effects:{}},ne=Object(ee.init)({models:{sheets:te,editor:R}});window.store=ne;var re=ne;c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(m.a,{store:re},a.a.createElement(Y,null))),document.getElementById("root"))},5:function(e,t,n){e.exports={focusBlock:"main_focusBlock__1BEst",editingBorder:"main_editingBorder__QkzpS",editingBorderTextContent:"main_editingBorderTextContent___xjOU",activeCellWrapper:"main_activeCellWrapper__2b12p"}},6:function(e,t,n){e.exports={app:"app_app__cewju",tableApplication:"app_tableApplication__3tpc6",rowsTitle:"app_rowsTitle__2Zbtn",cornerBlock:"app_cornerBlock__iLuJQ",dataContent:"app_dataContent__3hjQe",columnHeader:"app_columnHeader__298vN",contentTable:"app_contentTable__1qSbT"}},7:function(e,t,n){e.exports={grey:"main_grey__2Mkp3",tableContent:"main_tableContent__3uOra",barless:"main_barless__hNoCM",tableContainer:"main_tableContainer__2Zf2n",focus:"main_focus__-eHuC",cell:"main_cell__2WWoR"}}},[[21,1,2]]]);
//# sourceMappingURL=main.b46c809d.chunk.js.map
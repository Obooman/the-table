(this["webpackJsonpthe-table"]=this["webpackJsonpthe-table"]||[]).push([[0],{17:function(e,t,r){e.exports={columnTitle:"main_columnTitle__1FTAc",sort:"main_sort__2z94d"}},21:function(e,t,r){e.exports={rowHeaderItem:"main_rowHeaderItem__3Llca"}},23:function(e,t,r){e.exports={cell:"main_cell__1Fu2A"}},25:function(e,t,r){e.exports={cornerBlock:"main_cornerBlock__KFDIF"}},26:function(e,t,r){e.exports=r(37)},37:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(10),c=r.n(a),l=r(13),i=r(3),s=r(4),u=r(12),d=r.n(u),p=r(9),f=r.n(p);function h(e,t,r){return"repeating-linear-gradient(\n  transparent 0px,\n  transparent ".concat(t-1,"px,\n  ").concat(r," ").concat(t-1,"px,\n  ").concat(r," ").concat(t,"px\n),\nrepeating-linear-gradient(\n  90deg,\n  transparent 0px,\n  transparent ").concat(e-1,"px,\n  ").concat(r," ").concat(e-1,"px,\n  ").concat(r," ").concat(e,"px\n)")}function m(e){var t,r=e.size,a=e.cellSize,c=e.getData,u=e.onClick,p=e.theme,m=void 0===p?{}:p,v=e.scrollLeft,b=void 0===v?0:v,w=e.scrollTop,g=void 0===w?0:w,E=e.onScroll,O=e.children,j=e.locked,y=Object(n.useRef)(),_=Object(n.useState)([0,0]),x=Object(s.a)(_,2),C=x[0],S=x[1],k=Object(n.useState)([0,0]),M=Object(s.a)(k,2),T=M[0],z=M[1],B=Object(n.useState)([0,0]),N=Object(s.a)(B,2),I=N[0],L=N[1],V=Object(n.useState)([0,0]),A=Object(s.a)(V,2),F=A[0],D=A[1];Object(n.useEffect)((function(){var e=y.current.offsetWidth,t=y.current.offsetHeight,n=Math.ceil(e/a[0]),o=Math.ceil(t/a[1]),c=r[0]%n,l=r[1]%o,i=(2*n>r[0]?r[0]:2*n)+c,s=(2*o>r[1]?r[1]:2*o)+l,u=parseInt(r[0]/n)-1,d=parseInt(r[1]/o)-1;u>2&&(u-=1),d>2&&(d-=1),L([n,o]),z([i,s]),D([u,d])}),[r,a]),Object(n.useEffect)((function(){var e=y.current,t=function(t){var r=e.scrollTop,n=e.scrollLeft,o=!1,c=Object(s.a)(C,2),l=c[0],i=c[1],u=parseInt(n/(I[0]*a[0])),d=parseInt(r/(I[1]*a[1]));(u=u>F[0]?F[0]:u)!==l&&(o=!0),(d=d>F[1]?F[1]:d)!==i&&(o=!0),o&&S([u,d]),E&&E({scrollLeft:n,scrollTop:r})};return e.addEventListener("scroll",t,!1),function(){return e.removeEventListener("scroll",t,!1)}}),[T,C,a,E,I,F]);var U=d()((t={},Object(i.a)(t,f.a.grey,m.isGrey),Object(i.a)(t,f.a.tableContainer,!0),Object(i.a)(t,f.a.barless,m.barless),t));return Object(n.useEffect)((function(){if(j){y.current.addEventListener("mousewheel",(function(e){return e.preventDefault()}),!1)}}),[j]),Object(n.useEffect)((function(){y.current.scrollLeft=b,y.current.scrollTop=g}),[b,g]),o.a.createElement("div",{ref:y,className:U},o.a.createElement("div",{style:{width:r[0]*a[0],height:r[1]*a[1],overflow:"hidden"},onClick:u},o.a.createElement("div",{className:f.a.tableContent,style:{width:T[0]*a[0],height:T[1]*a[1],left:C[0]*I[0]*a[0],top:C[1]*I[1]*a[1],backgroundImage:h.apply(void 0,Object(l.a)(a).concat(["#d4d4d4"]))}},Array.from({length:T[0]}).map((function(e,t){return Array.from({length:T[1]}).map((function(e,r){return c({relative:{row:r,column:t},absolute:{row:C[1]*I[1]+r,column:C[0]*I[0]+t}})}))}))),O))}var v=r(2),b=r(21),w=r.n(b),g=r(5),E=Object(v.b)((function(e){return{scrollTop:e.editor.scrollPosition.scrollTop,cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.scrollTop,r=e.cellSize;return o.a.createElement(m,{locked:!0,size:[1,g.b[1]],cellSize:r,getData:function(e){var t=e.relative,n=t.row,a=t.column,c=e.absolute.row;return o.a.createElement("span",{className:w.a.rowHeaderItem,key:"".concat(n,"-").concat(a),style:{left:a*r[0],top:n*r[1],width:r[0],height:r[1]}},o.a.createElement("span",null,c+1))},theme:{barless:!0,isGrey:!0},scrollTop:t})})),O="a".charCodeAt(0),j="z".charCodeAt(0)-O+1;var y=r(17),_=r.n(y),x=r(1),C=function(e){return"number"===typeof e},S=function(e){return void 0===e},k=function(e){return 0===e.length};function M(e,t,r){var n=r?1:-1;return S(e)&&S(t)?0:S(e)&&!S(t)?1:!S(e)&&S(t)?-1:C(e)&&C(t)?n*(e-t):k(e)&&k(t)?0:k(e)&&!k(t)?1:!k(e)&&k(t)?-1:"string"===typeof e?n*e.localeCompare(t):-1*n*t.localeCompare(e)}var T={increase:"increase",decrease:"decrease"},z={state:{sortType:{},sorters:[]},reducers:{updateSorter:function(e,t){var r=t.nextSorters,n=t.currentSorter,o=Object(x.a)(Object(x.a)({},e.sortType),{},Object(i.a)({},n.column,n));return n.sortMode?o[n.column]=n:delete o[n.column],{sorters:r,sortType:o}}},effects:function(e){return{sort:function(t,r){var n,o=t.column,a=r.sorter,c=a.sortType,i=a.sorters,s=c[o];s?s.sortMode===T.increase?(s.sortMode=T.decrease,n=i.filter((function(e){return e.column!==o})).concat([s])):(s.sortMode=null,n=i.filter((function(e){return e.column!==o}))):(s={column:o,sortMode:T.increase},n=[].concat(Object(l.a)(i),[s])),e.sorter.updateSorter({nextSorters:n,currentSorter:s}),e.sheets.rebuildSheets(function(e,t){var r={};return function(e,t){return 0===t.length?e:e.sort((function(e,r){for(var n=t.length-1,o=0,a=t[n],c=a.sortMode,l=a.column;!(0!==o||n<0);){var i,s;o=M(null===(i=e[l])||void 0===i?void 0:i.value,null===(s=r[l])||void 0===s?void 0:s.value,c===T.increase),n--}return o}))}(Object.values(e),t).forEach((function(e,t){r[t]=e})),{rows:r}}(r.sheets.rows,n))}}}},B=Object(v.b)((function(e){return{scrollLeft:e.editor.scrollPosition.scrollLeft,sortType:e.sorter.sortType,cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.scrollLeft,r=e.sortType,n=e.dispatch,a=e.cellSize;return o.a.createElement(m,{locked:!0,size:[g.b[0],1],cellSize:a,getData:function(e){var t,c,l=e.relative,i=l.row,s=l.column,u=e.absolute.column;return o.a.createElement("span",{key:"".concat(i,"-").concat(s),className:_.a.columnTitle,style:{left:s*a[0],top:i*a[1],width:a[0],height:a[1]},onClick:function(){n.sorter.sort({column:u})}},o.a.createElement("span",null,function(e){for(var t="";e>=0;)t=String.fromCharCode(e%j+O)+t,e=Math.floor(e/j)-1;return t}(u).toUpperCase(),o.a.createElement("span",{className:_.a.sort},(null===(t=r[u])||void 0===t?void 0:t.sortMode)===T.increase&&"\u2b06",(null===(c=r[u])||void 0===c?void 0:c.sortMode)===T.decrease&&"\u2b07")))},theme:{isGrey:!0,barless:!0},scrollLeft:t})})),N=r(22),I=function(e){var t=e.toString();return/\./.test(t)?t.length-t.indexOf(".")-1:0},L={ExpressionStatement:!0,BinaryExpression:!0,UnaryExpression:!0,CallExpression:!0,Literal:!0,Identifier:!0},V="addition",A="subtraction",F="multiplication",D=function(e,t,r){var n=Math.pow(10,Math.max(I(e),I(t)));switch(r){case V:return(e*n+t*n)/n;case A:return(e*n-t*n)/n;case F:return e*n*t*n/n/n;default:throw new Error("Invalid arithmetic operator")}};var U=function(e){return/^[a-z]{1,3}\d{1,8}$$/gim.test(e)},P=function(e){return 0};function R(){for(var e=0,t=0,r=0,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];for(;e<o.length;){var c=o[e];"string"===typeof c&&(c=Number(c)),"number"!==typeof c&&(c=0);var l=I(c);l>r?(t*=Math.pow(10,l-r),c*=Math.pow(10,l),r=l):l<=r&&(c*=Math.pow(10,r)),t+=c,e++}return t/Math.pow(10,r)}var G={SUM:R,AVG:function(){return 0===arguments.length?0:R.apply(void 0,arguments)/arguments.length},PI:function(){return Math.PI}},W=function(e){return e.toUpperCase()in G},H=function(e){return W(e)&&G[e.toUpperCase()]},K=document.createElement("canvas").getContext("2d");function q(e){return void 0===e?0:(K.font="16px sans-serif",K.measureText(e).width)}var J=r(6),Z=r.n(J),$="focused",Q="editing",X={state:{mode:"normal",cell:{width:g.a[0],height:g.a[1]},scrollPosition:{scrollLeft:0,scrollTop:0},focusCell:{row:0,col:0},editingValue:""},reducers:{updateScrollPosition:function(e,t){return Object(x.a)(Object(x.a)({},e),{},{scrollPosition:t})},updateMode:function(e,t){return Object(x.a)(Object(x.a)({},e),{},{mode:t})},updateFocusCell:function(e,t){return Object(x.a)(Object(x.a)({},e),{},{focusCell:t})},updateEditingValue:function(e,t){return Object(x.a)(Object(x.a)({},e),{},{editingValue:t})}},effects:function(e){return{}}},Y=Object(v.b)((function(e){return{sheets:e.sheets,cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.dispatch,r=e.onBlur,a=e.sheets,c=e.row,l=e.col,i=e.cellSize,u=(a.rows[c]||{})[l]||{expression:"",value:""},d=Object(n.useState)(0),p=Object(s.a)(d,2),f=p[0],h=p[1];Object(n.useEffect)((function(){h(Math.max(1,f,Math.ceil(q(u.expression||u.value)/i[0])))}),[u,i,f]);var m=function(e){var n,o,a=e.target.value,i=/^=/.test(a);if(i){var u=function(e,t,r){var n=t.isVariable,o=t.getVariableValue,a=r.isFunction,c=r.getFunction;try{return[!1,function e(t){if(!L[t.type])throw new Error("Unsupported syntax block"+t.type);if("Literal"===t.type){if(!/\d+/.test(t.value))throw new Error("invalid literal value");return t.value}if("UnaryExpression"===t.type){if(!/\+|-/.test(t.operator))throw new Error("Invalid Unary Expression");return"+"===t.operator?e(t.argument):-e(t.argument)}if("BinaryExpression"===t.type){var r=e(t.right);switch(t.operator){case"+":return D(e(t.left),e(t.right),V);case"-":return D(e(t.left),e(t.right),A);case"*":return D(e(t.left),e(t.right),F);case"/":if(0===r)throw new Error("Got 0 as division");return e(t.left)/r;case"%":if(0===r)throw new Error("Got 0 as division");return e(t.left)%r;default:throw new Error("Unknown operator detected")}}if("CallExpression"===t.type){var l=t.callee.name;if(a(l))return c(l).apply(this,t.arguments.map((function(t){return e(t)})));throw new Error("calling unknown inset function")}if("Identifier"===t.type){if(n(t.name))return o(t.name);throw new Error("using undefined variable")}}(N.a(e,{ecmaVersion:2020}).body[0].expression)]}catch(l){return[l,0]}}(o=a.slice(1),{isVariable:U,getVariableValue:P},{isFunction:W,getFunction:H}),d=Object(s.a)(u,2),p=d[0],f=d[1];n=p?"#ERROR":f}else n=a;var h=n;i&&"#ERROR"!==n&&(h=Number(h)),!i&&function(e){return"number"===typeof e||"string"===typeof e&&(0!==e.length&&+e===+e)}(h)&&(h=Number(h)),t.sheets.updateValue({row:c,value:h,expression:o,column:l,isExpression:i}),r&&r(e)};return o.a.createElement("div",null,o.a.createElement("div",{className:Z.a.focusBlock,style:{width:f*i[0],height:i[1]},onChange:function(e){q(e.target.value)>f*i[0]&&(console.log(f),h(f+1))},onClick:function(e){e.stopPropagation()}},o.a.createElement("input",{defaultValue:u.isExpression?"=".concat(u.expression):u.value,autoFocus:!0,type:"text",className:Z.a.editingBorderTextContent,onBlur:function(e){m(e),r&&r(e)},onKeyDown:function(e){"Enter"===e.key&&m(e),"Escape"===e.key&&(m(e),t.editor.updateMode($))}})))})),ee=Object(v.b)((function(e){var t=e.sheets,r=e.editor;return{sheets:t,cellSize:[r.cell.width,r.cell.height]}}))((function(e){var t,r=e.sheets,n=e.row,a=e.col,c=e.cellSize,l=d()((t={},Object(i.a)(t,Z.a.cell,!0),Object(i.a)(t,Z.a.focusBlock,!0),t)),s=(r.rows[n]||{})[a]||{},u="value"in s?s.value:"";return o.a.createElement("div",{className:l,style:{width:c[0],height:c[1]}},u)})),te=Object(v.b)((function(e){return{sheets:e.sheets,mode:e.editor.mode,focusCell:e.editor.focusCell,cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.dispatch,r=e.focusCell,n=r.row,a=r.col,c=e.mode,l=e.cellSize,i={left:a*l[0],top:n*l[1]};return c===$?o.a.createElement("div",{onDoubleClick:function(e){t.editor.updateMode(Q)},onClick:function(e){e.stopPropagation()},className:Z.a.activeCellWrapper,style:i},o.a.createElement(ee,{row:n,col:a})):c===Q?o.a.createElement("div",{className:Z.a.activeCellWrapper,style:i},o.a.createElement(Y,{row:n,col:a,onBlur:function(){t.editor.updateMode($)}})):null})),re=r(23),ne=r.n(re);var oe=Object(v.b)((function(e){return{sheets:e.sheets,cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.relative,r=t.row,n=t.column,a=e.absolute,c=a.row,l=a.column,i=e.sheets,s=e.cellSize,u=(i.rows[c]||{})[l]||{},d="value"in u?u.value:"";return o.a.createElement("div",{className:ne.a.cell,key:"".concat(r,"-").concat(n),style:{left:n*s[0],top:r*s[1],width:s[0],height:s[1]}},d)})),ae=r(24),ce={state:{rows:{}},reducers:{updateValue:function(e,t){return Object(x.a)(Object(x.a)({},e),{},{rows:Object(x.a)(Object(x.a)({},e.rows),{},Object(i.a)({},t.row,Object(x.a)(Object(x.a)({},e.rows[t.row]),{},Object(i.a)({},t.column,t))))})},changeRow:function(e,t){var r=e.rows[999];return delete e.rows[999],Object(x.a)(Object(x.a)({},e),{},{rows:{0:r}})},rebuildSheets:function(e,t){return t}},effects:{}},le=Object(ae.init)({models:{sheets:ce,editor:X,sorter:z}});window.store=le;var ie=le;!function(e){var t=Object(s.a)(e,2),r=t[0],n=t[1];document.addEventListener("keydown",(function(e){var t=e.key,o=e.code,a=ie.getState().editor,c=a.focusCell,l=a.mode;/^Arrow\w+/.test(t)&&l===$&&(e.preventDefault(),"ArrowUp"===t?c.row>0&&ie.dispatch.editor.updateFocusCell(Object(x.a)(Object(x.a)({},c),{},{row:c.row-1})):"ArrowDown"===t?c.row<r-1&&ie.dispatch.editor.updateFocusCell(Object(x.a)(Object(x.a)({},c),{},{row:c.row+1})):"ArrowLeft"===t?c.col>0&&ie.dispatch.editor.updateFocusCell(Object(x.a)(Object(x.a)({},c),{},{col:c.col-1})):"ArrowRight"===t&&c.col<n-1&&ie.dispatch.editor.updateFocusCell(Object(x.a)(Object(x.a)({},c),{},{col:c.col+1}))),/^space$/i.test(o)&&l!==Q&&e.preventDefault(),/backspace|delete/i.test(o)&&l===$&&ie.dispatch.sheets.updateValue({row:c.row,column:c.col,value:"",isExpression:!1,expression:""}),/^Digit\d{1}|^Key[A-Z]+|Backquote|Slash|Backslash|Semicolon|BracketLeft|BracketRight|Comma|Period|Minus/.test(o)&&!e.metaKey&&l===$&&(e.preventDefault(),ie.dispatch.sheets.updateValue({row:c.row,column:c.col,value:t,isExpression:!1,expression:""}),ie.dispatch.editor.updateMode(Q)),/^Equal/.test(o)&&l===$&&(e.preventDefault(),ie.dispatch.sheets.updateValue({row:c.row,column:c.col,value:"",isExpression:!0,expression:""}),ie.dispatch.editor.updateMode(Q)),/KeyV/.test(o)&&e.metaKey&&ie.dispatch.editor.updateMode(Q)}),!1)}(g.b);var se=Object(v.b)((function(e){return{sheets:e.sheets,cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.dispatch,r=e.sheets,n=e.cellSize;return o.a.createElement(m,{size:g.b,cellSize:n,getData:function(e){var t,n,a=e.relative,c=a.row,l=a.column,i=e.absolute,s=i.row,u=i.column;return(null===(t=r.rows)||void 0===t||null===(n=t[s])||void 0===n?void 0:n[u])?o.a.createElement(oe,Object.assign({key:"".concat(c,"-").concat(l)},e)):null},onClick:function(e){t.editor.updateFocusCell({row:parseInt(e.nativeEvent.offsetY/n[1]),col:parseInt(e.nativeEvent.offsetX/n[0])}),t.editor.updateMode($)},theme:{isGrey:!1},onScroll:function(e){t.editor.updateScrollPosition(e)}},o.a.createElement(te,null))})),ue=r(25),de=r.n(ue),pe=Object(v.b)((function(e){return{cellSize:[e.editor.cell.width,e.editor.cell.height]}}))((function(e){var t=e.cellSize;return o.a.createElement("div",{className:de.a.cornerBlock,style:{height:t[1]}})})),fe=r(7),he=r.n(fe);var me=function(){return o.a.createElement("div",{className:he.a.app},o.a.createElement("div",{className:he.a.tableApplication},o.a.createElement("div",{className:he.a.rowsTitle},o.a.createElement(pe,null),o.a.createElement(E,null)),o.a.createElement("div",{className:he.a.dataContent},o.a.createElement("div",{className:he.a.columnHeader},o.a.createElement(B,null)),o.a.createElement("div",{className:he.a.contentTable},o.a.createElement(se,null)))))};c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(v.a,{store:ie},o.a.createElement(me,null))),document.getElementById("root"))},5:function(e){e.exports=JSON.parse('{"b":[1000,1000],"a":[60,20]}')},6:function(e,t,r){e.exports={focusBlock:"main_focusBlock__1BEst",editingBorder:"main_editingBorder__QkzpS",editingBorderTextContent:"main_editingBorderTextContent___xjOU",activeCellWrapper:"main_activeCellWrapper__2b12p",cell:"main_cell__1jeUE"}},7:function(e,t,r){e.exports={app:"app_app__cewju",tableApplication:"app_tableApplication__3tpc6",rowsTitle:"app_rowsTitle__2Zbtn",dataContent:"app_dataContent__3hjQe",contentTable:"app_contentTable__1qSbT"}},9:function(e,t,r){e.exports={grey:"main_grey__2Mkp3",tableContent:"main_tableContent__3uOra",barless:"main_barless__hNoCM",tableContainer:"main_tableContainer__2Zf2n",focus:"main_focus__-eHuC",cell:"main_cell__2WWoR"}}},[[26,1,2]]]);
//# sourceMappingURL=main.d4042db8.chunk.js.map